<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SEFVBN2ML1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-SEFVBN2ML1');
    </script>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/banana.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Time evolution of wavefunctions in a harmonic oscillator</title>

    <meta name="description" content="Diving into the time evolution of a particle in a quantum harmonic oscillator.">
    <meta property="og:title" content="Time evolution of wavefunctions in a harmonic oscillator">
    <meta property="og:description" content="Diving into the time evolution of a particle in a quantum harmonic oscillator.">
    <meta property="og:image" content="https://physicsmonkey.com/posts/time-evolution-harmonic-oscillator/harmonic-oscillator-wavefunctions.webp">
    <meta property="og:url" content="https://physicsmonkey.com/posts/time-evolution-harmonic-oscillator/">
    <link rel="canonical" href="https://physicsmonkey.com/posts/time-evolution-harmonic-oscillator/">

    <link href="../../style/main.css" type="text/css" rel="stylesheet">
    <link href="../../style/navbar.css" type="text/css" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&family=PT+Sans&display=swap" rel="stylesheet"> 
  </head>
  <body>
    <nav class="navbar">
      <div class="navbar-main">
        <a href="../../">
          <img alt="PhysicsMonkey.com logo" height="48" width="48" class="logo" src="/banana.svg">
        </a>
        <ul class="nav-ul">
          <li class="nav-li"><a class="nav-a" href="../../">Home</a></li>
          <li class="nav-li"><a class="nav-a" href="../../about/">About</a></li>
          <li class="nav-li"><a class="nav-a" href="../../contact/">Contact</a></li>
        </ul>
      </div>
      <a href="../../" class="nav-a" id="website-name-label">
        PhysicsMonkey.com
      </a>
    </nav>

    <div class="main">
			<h1>Time evolution of wavefunctions in a harmonic oscillator</h1>
      <p class="post-date">Posted on <time datetime="2023-07-30">30/07/2023</time></p>
			<p>
        We've all seen graphs of the first few eigenkets in the quantum simple 
				harmonic oscillator, but how do pure and superposition state wavefunctions 
				evolve with time in a SHO potential? Let's see!
      </p>
			<p>
				We'll first have a look at the <a class="anchor-link" href="#time-independant">time-independant solutions</a>, a necessary step before diving deeper. 
        Then, we'll see how 
        <a class="anchor-link" href="#eigenfunctions">eigenfunctions evolve with time</a>, and finish with the most interesting case,
        the <a class="anchor-link" href="#superpositions">time dependance of superposition states</a>.
			</p>
      <div class="illustration-container">
        <img src="./harmonic-oscillator-wavefunctions.webp" width="512" alt="Wavefunctions in a harmonic oscillator." class="illustration">
        <label class="illustration-label">Eigenfunctions and probability density functions. Image from <a class="illustration-link" href="https://commons.wikimedia.org/wiki/File:Harmonic-oscillator-eigenstates.svg">Wikimedia Commons</a>.</label>
      </div>

      <h2>Time-independant solutions</h2>
      <div class="anchor" id="time-independant"></div>
      <p>
        The classical simple harmonic oscillator is characterised by a 
        <a href="https://en.wikipedia.org/wiki/Hooke%27s_law">Hooke's law</a> 
        potential:
      </p>
      <div class="math-block">
        <math display="block" style="display:block math;"><mrow><mi>V</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>k</mi><msup><mi>x</mi><mn>2</mn></msup></mrow></math>
      </div>
      <p>
        With <math><mi>k</mi></math> the spring constant. Simple harmonic 
        oscillators are often studied in classical physics through 
        pendulums and springs. The 
        quantum version of such an oscillator has the same potential, 
        usually rewritten as:
      </p>
      <div class="math-block">
        <math display="block" style="display:block math;"><mrow><mi>V</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>m</mi><msup><mi>ω</mi><mn>2</mn></msup><msup><mi>x</mi><mn>2</mn></msup></mrow></math>
      </div>
      <p>
        With angular frequency <math><mi>ω</mi></math>. One can use the 
        <a href="../schrodinger-equation/">Schrödinger equation</a> 
        to find the energy eigenvalues 
        <math><msub><mi>E</mi><mi>n</mi></msub></math>
        and eigenfunctions 
        <math><msub><mi>ψ</mi><mi>n</mi></msub></math>
        of this potential. The energy eigenvalues have a beautifully 
        simple formula:
      </p>
      <div class="math-block">
        <math display="block" style="display:block math;"><mrow><msub><mi>E</mi><mi>n</mi></msub><mo>=</mo><mi>ℏ</mi><mi>ω</mi><mrow><mo fence="true" form="prefix">(</mo><mi>n</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo fence="true" form="postfix">)</mo></mrow></mrow></math>
      </div>
      <p>
        There is something remarkable about this: energy levels in the 
        quantum harmonic oscillator are <b>evenly spaced</b>, with a 
        separation of <math><mrow><mi>ℏ</mi><mi>ω</mi></mrow></math>.      
      </p>
      <p>
        However, we're not so lucky with energy eigenfunctions, there's no 
        analytical solution for them. But fear not! There's a relatively 
        simple recurrence relation for them that uses 
        <b>ladder operators</b>:
      </p>
      <div class="math-block">
        <math display="block" style="display:block math;"><mrow><mi>|</mi><msub><mi>ψ</mi><mi>n</mi></msub><mo form="postfix" stretchy="false">⟩</mo><mo>=</mo><mfrac><msup><mi>A</mi><mi>n</mi></msup><msqrt><mrow><mi>n</mi><mo form="postfix" stretchy="false">!</mo></mrow></msqrt></mfrac><mi>|</mi><msub><mi>ψ</mi><mn>0</mn></msub><mo form="postfix" stretchy="false">⟩</mo></mrow></math>
      </div>
      <p>
        <math><mi>A</mi></math> is the so-called <b>raising operator</b>, 
        with formula:
      </p>
      <div class="math-block">
        <math display="block" style="display:block math;"><mrow><mi>A</mi><mo>=</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mrow><mo fence="true" form="prefix">(</mo><msqrt><mfrac><mrow><mi>m</mi><mi>ω</mi></mrow><mi>ℏ</mi></mfrac></msqrt><mi>x</mi><mo>−</mo><msqrt><mfrac><mi>ℏ</mi><mrow><mi>m</mi><mi>ω</mi></mrow></mfrac></msqrt><mfrac><mrow><mi mathvariant="normal">d</mi></mrow><mrow><mrow><mi mathvariant="normal">d</mi></mrow><mi>x</mi></mrow></mfrac><mo fence="true" form="postfix">)</mo></mrow></mrow></math>
      </div>
      <p>
        Starting from the ground-state wavefunction and using the 
        formulae above, we can calculate the first few energy eigenkets:
      </p>
      <div class="math-block">
        <math display="block" style="display:block math;"><mrow><mi>|</mi><msub><mi>ψ</mi><mn>0</mn></msub><mo form="postfix" stretchy="false">⟩</mo><mo>=</mo><msup><mrow><mo fence="true" form="prefix">(</mo><mfrac><mrow><mi>m</mi><mi>ω</mi></mrow><mrow><mi>π</mi><mi>ℏ</mi></mrow></mfrac><mo fence="true" form="postfix">)</mo></mrow><mfrac><mn>1</mn><mn>4</mn></mfrac></msup><msup><mi>e</mi><mrow><mo>−</mo><mfrac><mrow><mi>m</mi><mi>ω</mi><msup><mi>x</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><mi>ℏ</mi></mrow></mfrac></mrow></msup></mrow></math>
      </div>
      <div class="math-block">
        <math display="block" style="display:block math;"><mrow><mi>|</mi><msub><mi>ψ</mi><mn>1</mn></msub><mo form="postfix" stretchy="false">⟩</mo><mo>=</mo><msup><mrow><mo fence="true" form="prefix">(</mo><mfrac><mrow><mi>m</mi><mi>ω</mi></mrow><mrow><mi>π</mi><mi>ℏ</mi></mrow></mfrac><mo fence="true" form="postfix">)</mo></mrow><mfrac><mn>1</mn><mn>4</mn></mfrac></msup><msqrt><mfrac><mrow><mn>2</mn><mi>m</mi><mi>ω</mi></mrow><mi>ℏ</mi></mfrac></msqrt><mi>x</mi><msup><mi>e</mi><mrow><mo>−</mo><mfrac><mrow><mi>m</mi><mi>ω</mi><msup><mi>x</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><mi>ℏ</mi></mrow></mfrac></mrow></msup></mrow></math>
      </div>
      <div class="math-block">
        <math display="block" style="display:block math;"><mrow><mi>|</mi><msub><mi>ψ</mi><mn>2</mn></msub><mo form="postfix" stretchy="false">⟩</mo><mo>=</mo><msup><mrow><mo fence="true" form="prefix">(</mo><mfrac><mrow><mi>m</mi><mi>ω</mi></mrow><mrow><mi>π</mi><mi>ℏ</mi></mrow></mfrac><mo fence="true" form="postfix">)</mo></mrow><mfrac><mn>1</mn><mn>4</mn></mfrac></msup><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mrow><mo fence="true" form="prefix">(</mo><mfrac><mrow><mn>2</mn><mi>m</mi><mi>ω</mi></mrow><mi>ℏ</mi></mfrac><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>1</mn><mo fence="true" form="postfix">)</mo></mrow><msup><mi>e</mi><mrow><mo>−</mo><mfrac><mrow><mi>m</mi><mi>ω</mi><msup><mi>x</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><mi>ℏ</mi></mrow></mfrac></mrow></msup></mrow></math>
      </div>
      <div class="math-block">
        <math display="block" style="display:block math;"><mrow><mi>|</mi><msub><mi>ψ</mi><mn>3</mn></msub><mo form="postfix" stretchy="false">⟩</mo><mo>=</mo><msup><mrow><mo fence="true" form="prefix">(</mo><mfrac><mrow><mi>m</mi><mi>ω</mi></mrow><mrow><mi>π</mi><mi>ℏ</mi></mrow></mfrac><mo fence="true" form="postfix">)</mo></mrow><mfrac><mn>1</mn><mn>4</mn></mfrac></msup><mfrac><mn>1</mn><msqrt><mn>3</mn></msqrt></mfrac><mrow><mo fence="true" form="prefix">(</mo><mn>2</mn><msup><mrow><mo fence="true" form="prefix">(</mo><mfrac><mrow><mi>m</mi><mi>ω</mi></mrow><mi>ℏ</mi></mfrac><mo fence="true" form="postfix">)</mo></mrow><mfrac><mn>3</mn><mn>2</mn></mfrac></msup><msup><mi>x</mi><mn>3</mn></msup><mo>−</mo><mn>3</mn><msqrt><mfrac><mrow><mi>m</mi><mi>ω</mi></mrow><mi>ℏ</mi></mfrac></msqrt><mi>x</mi><mo fence="true" form="postfix">)</mo></mrow><msup><mi>e</mi><mrow><mo>−</mo><mfrac><mrow><mi>m</mi><mi>ω</mi><msup><mi>x</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><mi>ℏ</mi></mrow></mfrac></mrow></msup></mrow></math>
      </div>
      <p>
        It's important to note that every even eigenket is an even function, 
        and every odd eigenket is odd. This is actually a 
        property of symmetric potentials, which is also the case of the 
        <a href="../infinite-square-well-1d/">infinitely deep square well</a>!
      </p>
      <p>
        The first few eigenket are displayed in the graph below.
      </p>
      <div class="illustration-container">
        <img src="./harmonic-eigenfunctions.webp" width="512" alt="Harmonic oscillator eigenfunctions" class="illustration">
        <label class="illustration-label">First eight energy eigenfunctions, from <a href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator">Wikipedia</a>.</label>
      </div>
      <p>
        We can now move on to time considerations!
      </p>
      <h2>Time evolution of eigenkets</h2>
      <div class="anchor" id="eigenfunctions"></div>
      <p>
        As always, probability density functions that describe base 
        states are independant of time. But it doesn't mean that 
        energy eigenfunctions themselves don't vary with time! Their factor of 
        <math><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mfrac><msub><mi>E</mi><mi>n</mi></msub><mi>ℏ</mi></mfrac><mi>t</mi></mrow></msup></math>
         makes them complex functions, with real and complex parts that 
        oscillate with time. The following graph shows what it looks like:
      </p>
      
      <div class="graph-container">
        <div id="plot1" class="graph"></div>
        <div class="slider-row">
          <div class="slider-container">
            <label for="sliderN" class="txt-center">Quantum number n=<span id="nLabel"></span></label>
            <input type="range" min="0" max="3" step="1" id="sliderN">
          </div>
        </div>
      </div>
      <p>
        In the graph above, 
        <math><msub><mi>x</mi><mn>0</mn></msub></math> 
        stands for the <b>natural length</b> 
        of the harmonic oscillator, with formula:
      </p>
      <div class="math-block">
        <math display="block" style="display:block math;"><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><msqrt><mfrac><mrow><mi>m</mi><mi>ω</mi></mrow><mi>ℏ</mi></mfrac></msqrt></mrow></math>
      </div>
      <p>
        You can see that the higher the excited state, the 
        faster the oscillation! This is 
        due to the fact that energy eigenvalues 
        <math><msub><mi>E</mi><mi>n</mi></msub></math>
        grow linearly with <math><mi>n</mi></math>. However, 
        in comparison, eigenkets in the infinitely deep square well 
        oscillate much faster, due the factor of 
        <math><msup><mi>n</mi><mn>2</mn></msup></math> 
        in the energy eigenvalues of the well. You can compare the 
        oscillation of eigenkets in the harmonic oscillator with 
        <a href="../time-dependance-well-1d/">the time-dependance of eigenkets for a particle in a box</a>.    
      </p>
      <p>
        We can now have a look at superposition states.
      </p>
      <h2>Superpositions</h2>
      <div class="anchor" id="superpositions"></div>
      <p>
        Superposition states are a <b>normalized sum of eigenkets</b>, with 
        potentially different coefficients for each eigenket. For example, 
        a simple superposition state 
        <math><mrow><mi>|</mi><mi>ψ</mi><mo form="postfix" stretchy="false">⟩</mo></mrow></math>
        could be made with an equal weight of 
        <math><mrow><mi>|</mi><msub><mi>ψ</mi><mn>0</mn></msub><mo form="postfix" stretchy="false">⟩</mo></mrow></math>
        and 
        <math><mrow><mi>|</mi><msub><mi>ψ</mi><mn>1</mn></msub><mo form="postfix" stretchy="false">⟩</mo></mrow></math>:
      </p>
      
      <div class="math-block">
        <math display="block" style="display:block math;"><mrow><mi>|</mi><mi>ψ</mi><mo form="postfix" stretchy="false">⟩</mo><mo>=</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mrow><mo fence="true" form="prefix">(</mo><mi>|</mi><msub><mi>ψ</mi><mn>0</mn></msub><mo form="postfix" stretchy="false">⟩</mo><mo>+</mo><mi>|</mi><msub><mi>ψ</mi><mn>1</mn></msub><mo form="postfix" stretchy="false">⟩</mo><mo fence="true" form="postfix">)</mo></mrow></mrow></math>
      </div>
      <p>
        To find the time-dependance of superposition states, just 
        add to each eigenket a factor of 
        <math><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mfrac><msub><mi>E</mi><mi>n</mi></msub><mi>ℏ</mi></mfrac><mi>t</mi></mrow></msup></math>.
        For our superposition state 
        <math><mrow><mi>|</mi><mi>ψ</mi><mo form="postfix" stretchy="false">⟩</mo></mrow></math>
        in a harmonic oscillator, this results in:
      </p>
      <div class="math-block">
        <math display="block" style="display:block math;"><mrow><mi>|</mi><mi>ψ</mi><mo form="prefix" stretchy="false">(</mo><mi>t</mi><mo form="postfix" stretchy="false">)</mo><mo form="postfix" stretchy="false">⟩</mo><mo>=</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mrow><mo fence="true" form="prefix">(</mo><mi>|</mi><msub><mi>ψ</mi><mn>0</mn></msub><mo form="postfix" stretchy="false">⟩</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mfrac><msub><mi>E</mi><mn>0</mn></msub><mi>ℏ</mi></mfrac><mi>t</mi></mrow></msup><mo>+</mo><mi>|</mi><msub><mi>ψ</mi><mn>1</mn></msub><mo form="postfix" stretchy="false">⟩</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mfrac><msub><mi>E</mi><mn>1</mn></msub><mi>ℏ</mi></mfrac><mi>t</mi></mrow></msup><mo fence="true" form="postfix">)</mo></mrow></mrow></math>
      </div>
      <p>
        Using this, we can obtain the time-dependance of the 
        probability density function that represents that state:
      </p>
      <div class="math-block">
        <math display="block" style="display:block math;"><mrow><msup><mi>ψ</mi><mo>*</mo></msup><mi>ψ</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo fence="true" form="prefix">(</mo><msubsup><mi>ψ</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>ψ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msub><mi>ψ</mi><mn>0</mn></msub><msub><mi>ψ</mi><mn>1</mn></msub><mrow><mo fence="true" form="prefix">(</mo><msup><mi>e</mi><mrow><mi>i</mi><mfrac><mi>t</mi><mi>ℏ</mi></mfrac><mrow><mo fence="true" form="prefix">(</mo><msub><mi>E</mi><mn>1</mn></msub><mo>−</mo><msub><mi>E</mi><mn>0</mn></msub><mo fence="true" form="postfix">)</mo></mrow></mrow></msup><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mfrac><mi>t</mi><mi>ℏ</mi></mfrac><mrow><mo fence="true" form="prefix">(</mo><msub><mi>E</mi><mn>1</mn></msub><mo>−</mo><msub><mi>E</mi><mn>0</mn></msub><mo fence="true" form="postfix">)</mo></mrow></mrow></msup><mo fence="true" form="postfix">)</mo></mrow><mo fence="true" form="postfix">)</mo></mrow></mrow></math>
      </div>
      <p>
        Where we can replace the ugly coefficient on the right using 
        the <a href="https://proofwiki.org/wiki/Cosine_Exponential_Formulation">exponential form of cosine</a> 
        to get:
      </p>
      <div class="math-block">
        <math display="block" style="display:block math;"><mrow><msup><mi>ψ</mi><mo>*</mo></msup><mi>ψ</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo fence="true" form="prefix">(</mo><msubsup><mi>ψ</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>ψ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><mn>2</mn><msub><mi>ψ</mi><mn>0</mn></msub><msub><mi>ψ</mi><mn>1</mn></msub><mrow><mi>cos</mi><mo>⁡</mo></mrow><mrow><mo fence="true" form="prefix">(</mo><mfrac><mi>t</mi><mi>ℏ</mi></mfrac><mrow><mo fence="true" form="prefix">(</mo><msub><mi>E</mi><mn>1</mn></msub><mo>−</mo><msub><mi>E</mi><mn>0</mn></msub><mo fence="true" form="postfix">)</mo></mrow><mo fence="true" form="postfix">)</mo></mrow><mo fence="true" form="postfix">)</mo></mrow></mrow></math>
      </div>
      <p>
        A much nicer equation! This shows that time-dependant 
        terms in probability density functions come from 
        <b>cross-factors between different eigenkets</b>.
      </p>
      <p>
        Using this knowledge, we can plot the time-dependance 
        of superposition states in a harmonic oscillator:
      </p>

      <div class="graph-container">
        <div id="plot2" class="graph"></div>
        <div id="expression-container" class="expression-container">          
          <div class="math-block" id="graph-expression">
            <math display="block" style="display:block math;"><mrow><msup><mi>ψ</mi><mo>*</mo></msup><mi>ψ</mi><mo>=</mo><msup><mrow><mo fence="true" form="prefix">|</mo><mn id="aTot"></mn><mrow><mo fence="true" form="prefix">(</mo><mrow id="expr1"><mn id="a1"></mn><msub><mi>ψ</mi><mn>0</mn></msub><mo form="prefix" stretchy="false">(</mo><mi>t</mi><mo form="postfix" stretchy="false">)</mo></mrow><mo id="plus1">+</mo><mrow id="expr2"><mn id="a2"></mn><msub><mi>ψ</mi><mn>1</mn></msub><mo form="prefix" stretchy="false">(</mo><mi>t</mi><mo form="postfix" stretchy="false">)</mo></mrow><mo id="plus2">+</mo><mrow id="expr3"><mn id="a3"></mn><msub><mi>ψ</mi><mn>2</mn></msub><mo form="prefix" stretchy="false">(</mo><mi>t</mi><mo form="postfix" stretchy="false">)</mo></mrow><mo fence="true" form="postfix">)</mo></mrow><mo fence="true" form="postfix">|</mo></mrow><mn>2</mn></msup></mrow></math>
          </div>
          <div id="invalid-expression" style="text-align: center;display: none;color: red; padding:10px 0;">Invalid expression</div>
        </div>
        

        <div class="slider-container-line">
          <div class="slider-col" style="flex-grow:1">
            <button id="btnT0" class="btn">Set t=0</button>
            <button id="btnStopStart" class="btn">Pause</button>
          </div>
          <div class="slider-container" style="flex-grow:2">
            <label>Change amplitudes:</label>
            <div class="slider-col">
              <div class="slider-container-line">
                <label for="sliderA1">A<sub>0</sub></label>
                <input class="slider" value="1" id="sliderA1" type="range" min="-1" max="1" step="0.1" value="0.3">
              </div>
              <div class="slider-container-line">
                <label for="sliderA2">A<sub>1</sub></label>
                <input class="slider" value="-0.5" id="sliderA2" type="range" min="-1" max="1" step="0.1" value="-0.8">
              </div>
              <div class="slider-container-line">
                <label for="sliderA3">A<sub>2</sub></label>
                <input class="slider" value="0" id="sliderA3" type="range" min="-1" max="1" step="0.1" value="0.7">
              </div>
            </div>
          </div>
        </div>
      </div>
      <p>
        Feel free to play around and experiment with the controls. 
        Remember that higher values of the probability 
        density function in a certain area represents a higher 
        chance to find the particle in that area.
      </p>
      <script type="module" src="sho-plots.js" defer></script>
    </div>
  </body>
</html>
